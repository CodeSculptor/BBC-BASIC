30MODE7
40PROCinit
50FORI%=0TO1
60VDU31;I%,132,157,131,141,14,23;10,64;0;0;0;:PRINTSPC9"SJ's TOOLBOX"
70NEXT
80ONERRORVDU3,26:IFERR<>17ANDERR<>0PROCerror
90REPEAT
100VDU26
110PROCblank
120VDU31;5,132,157,134:PRINT;proc$;" Processor   HARDCOPY ";hard$;
130VDU31;6,132,157,134
140IFsec%=0ANDtube%=0THENPRINT"ROM";CHR$131;rom ELSEPRINT"      "
150PRINTTAB(0,2)CHR$32CHR$157CHR$129"Command (D,M,E,P,H,R,W):";
160opt=INSTR("EePpHhRrWwMmDd",GET$)
170opt=(opt+1)DIV2
180IFopt<1ORopt>7THEN160
190IFopt=1@%=&A0A:VDU12:END
200IFopt=3PROChard:GOTO340
210IFopt=2PROCsec:GOTO340
220IFopt=4PROCrom:GOTO340
230IFopt=5PROCwhat:GOTO340
240PROCblank:VDU14
250INPUTTAB(3,3)"Start &"addr$
260addr%=EVAL("&"+addr$)
270IFaddr%<0ORaddr%>&FFFFTHENaddr%=0
280IFhard%INPUTTAB(3,4)"Finish &"addr$ELSEaddr$="FFFF"
290end%=EVAL("&"+addr$)
300IFend%<=addr%PRINTTAB(10,4)"That's DAFT!":delay=INKEY500:GOTO110
310PROCsetup
320IFopt=6PROCdump:GOTO340
330IFopt=7PROCdis
340UNTIL0
350END
360DEFPROCinit
370DIMD$(255)
380FORI%=0TO255:READD$(I%):NEXT
390@%=&303
400blank$=CHR$134+CHR$157+CHR$132+STRING$(34," ")
410X%=0:Y%=&FF
420A%=&EA:tube%=((USR&FFF4)AND&FFFF)DIV256
430A%=&FC:rom=((USR&FFF4)AND&FFFF)DIV256
440IFtube%proc$="2nd":sec%=TRUE ELSEproc$="I/O":sec%=FALSE
450hard$="Off":hard%=FALSE
460ENDPROC
470DEFPROCerror
480VDU31,3,2,7:REPORT:PRINT" at line ";ERL
490PRINTTAB(3,4)"Press 'space' to continue";
500REPEATUNTILGET=32
510ENDPROC
520DEFPROCblank:PRINTTAB(0,3)blank$:PRINTTAB(0,4)blank$:ENDPROC
530DEFPROCsetup
540VDU28;24,39,8,12
550IFhard%VDU2,15VDU3,14
560ENDPROC
570DEFPROChard
580IFhard%=FALSE hard%=TRUE:hard$="On "ELSEhard%=FALSE:hard$="Off"
590ENDPROC
600DEFPROCrom
610IFtube%ORsec%PROCcannot:ENDPROC
620REPEAT
630PROCblank
640INPUTTAB(3,3)"Rom no. "rom$:IFrom$=""THEN660
650rom=EVAL(rom$)
660UNTILrom<16ORrom$=""
670ENDPROC
680DEFPROCsec
690IFNOTtube%AND&FFVDU7:PRINTTAB(3,4)"Tube not installed!";:delay=INKEY500:ENDPROC
700IFsec%=FA.sec%=TRUE:proc$="2nd"ELSEsec%=FALSE:proc$="I/O"
710ENDPROC
720DEFPROCcannot
730PRINTTAB(3,4)"Not available from 2nd processor"
740VDU7:delay=INKEY500:ENDPROC
750DEFPROCwhat
760IFtube%PROCcannot:ENDPROC
770PROCsetup
780FORr%=0TO15
790PRINT'"Rom ";r%;" ";
800IFr%?&2A1=0THEN880
810loc=&8009
820val=FNrom(loc,r%)
830REPEAT
840IFval>31ANDval<127PRINTCHR$val;:ELSEPRINT".";
850loc=loc+1
860val=FNrom(loc,r%)
870UNTILval=0
880NEXT
890VDU3,15
900ENDPROC
910DEFFNlook(loc)
920IFsec%THEN=?loc
930IF(NOTtube%AND&FF)ANDsec%=FALSE THEN=FNrom(loc,rom)
940A%=5:X%=&70:Y%=0
950!X%=loc
960CALL&FFF1
970=X%?4
980DEFFNrom(loc,rom%)
990!&F6=loc
1000Y%=rom%
1010=((USR&FFB9)AND&FF)
1020DEFPROCdis
1030REPEAT
1040info$=D$(FNlook(addr%))
1050bytes%=VALinfo$
1060op$=MID$(info$,2,3)
1070type%=VALMID$(info$,5)
1080PRINT~addr%;" ";
1090FORI%=0TObytes%
1100PRINT,RIGHT$("0"+STR$~(FNlook(addr%+I%)),2);
1110NEXT
1120addr%=addr%+1
1130PRINTTAB(17)op$;" ";
1140ONtype%GOSUB1200,1210,1220,1230,1240,1250,1260,1270,1280,1290,1300,1310,1315ELSE1150
1150PRINT
1160addr%=addr%+bytes%
1170UNTILaddr%>end%
1180VDU3,15
1190ENDPROC
1200PROCimm:RETURN
1210PROCabs:RETURN
1220PROCabsX:RETURN
1230PROCabsY:RETURN
1240PROCrel:RETURN
1250PROCzero:RETURN
1260PROCzeroX:RETURN
1270PROCzeroY:RETURN
1280PROCacc:RETURN
1290PROCind:RETURN
1300PROCindX:RETURN
1310PROCindY:RETURN
1315PROCabsindX:RETURN
1320DEFPROCimm
1330imm%=FNlook(addr%)
1340PRINT"#&";~imm%;:PROCbinary(imm%)
1350IFimm%>31ANDimm%<127PRINT" '"CHR$imm%"'";
1360ENDPROC
1370DEFPROCabs
1380value%=256*(FNlook(addr%+1))+FNlook(addr%)
1390IFvalue%>&FFB8 PROCoscall:ENDPROC
1400IFvalue%>=&200 ANDvalue%<=&22ePROCoscall:ENDPROC
1410PRINT"&";~value%;
1420ENDPROC
1430DEFPROCabsX:PROCabs:PRINT;",X";:ENDPROC
1470DEFPROCabsY:PROCabs:PRINT;",Y";:ENDPROC
1510DEFPROCrel
1520offset=(FNlook(addr%)+1)
1530IFoffset>127offset=offset-256
1540BRANCH=addr%+offset
1550PRINT"&";~BRANCH;
1560ENDPROC
1570DEFPROCzero:PRINT"&";~FNlook(addr%);:ENDPROC
1600DEFPROCzeroX:PROCzero:PRINT;",X";:ENDPROC
1640DEFPROCzeroY:PROCzero:PRINT;",Y";:ENDPROC
1680DEFPROCacc:PRINT;"A";:ENDPROC
1710DEFPROCind:PRINT"(";:PROCabs:PRINT")";:ENDPROC
1750DEFPROCindX:PRINT"(&";~FNlook(addr%)",X)";:ENDPROC
1760PRINT"(&";~FNlook(addr%)",X)";:ENDPROC
1780DEFPROCindY:PRINT"(&";~FNlook(addr%)"),Y";:ENDPROC
1790DEFPROCabsindX:PRINT"(";:PROCabs:PRINT",X)";:ENDPROC
1810DEFPROCbinary(imm%)
1820PRINTTAB(26)"%";
1830FORI%=7TO0STEP-1
1840IF(2^I%ANDimm%)=2^I%PRINT"1";ELSEPRINT"0";
1850NEXT
1860ENDPROC
1870DEFPROCoscall
1880IFvalue%>&FFB8RESTORE2420ELSERESTORE2530
1890found=FALSE:REPEAT
1900READos$:IFEVAL(os$)=value% found=TRUE
1910READos$:UNTILfound=TRUE ORos$="*"
1920PRINT"&";~value%;:IFfound=TRUE PRINT" =";os$;
1930ENDPROC
1940DEFPROCdump
1950REPEAT
1960PRINT~addr%;" ";
1970FORI%=0TO7
1980L%=FNlook(addr%+I%):PRINT" "CHR$((L%<&10)*-48);~L%;
1990NEXT
2000PRINT"  ";
2010FORI%=0TO7
2020V=FNlook(addr%+I%)
2030IFV<32ORV>126PRINT".";ELSEVDUV
2040NEXT
2050PRINT
2060addr%=addr%+8
2070UNTILaddr%>end%
2080VDU3,15
2090ENDPROC
2100DATA0BRK0,1ORA11,0...,0...,1TSB6,1ORA6,1ASL6,0...
2110DATA0PHP0,1ORA1,0ASL9,0...,2TSB2,2ORA2,2ASL2,0...
2120DATA1BPL5,1ORA12,0...,0...,1TRB6,1ORA7,1ASL7,0...
2130DATA0CLC0,2ORA4,0INC9,0...,2TRB2,2ORA3,2ASL3,0...
2140DATA2JSR2,1AND11,0...,0...,1BIT6,1AND6,1ROL6,0...
2150DATA0PLP0,1AND1,0ROL9,0...,2BIT2,2AND2,2ROL2,0...
2160DATA1BMI5,1AND12,0...,0...,1BIT7,1AND7,1ROL7,0...
2170DATA0SEC0,2AND4,0DEC9,0...,2BIT3,2AND3,2ROL3,0...
2180DATA0RTI0,1EOR11,0...,0...,0...,1EOR6,1LSR6,0...
2190DATA0PHP0,1EOR1,0LSR9,0...,2JMP2,2EOR2,2LSR2,0...
2200DATA1BVC5,1EOR12,0...,0...,0...,1EOR7,1LSR7,0...
2210DATA0CLI0,2EOR4,0PHY0,0...,0...,2EOR3,2LSR3,0...
2220DATA0RTS0,1ADC11,0...,0...,1STZ6,1ADC6,1ROR6,0...
2230DATA0PLA0,1ADC1,0ROR9,0...,2JMP10,2ADC2,2ROR2,0...
2240DATA1BVS5,1ADC12,0...,0...,1STZ7,1ADC7,1ROR7,0...
2250DATA0SEI0,2ADC4,0PLY0,0...,2JMP13,2ADC3,2ROR3,0...
2260DATA1BRA6,1STA11,0...,0...,1STY6,1STA6,1STX6,0...
2270DATA0DEY0,0...,0TXA0,0...,2STY2,2STA2,2STX2,0...
2280DATA1BCC5,1STA12,0...,0...,1STY7,1STA7,1STX8,0...
2290DATA0TYA0,2STA4,0TXS0,0...,2STZ2,2STA3,2STZ3,0...
2300DATA1LDY1,1LDA11,1LDX1,0...,1LDY6,1LDA6,1LDX6,0...
2310DATA0TAY,1LDA1,0TAX,0...,2LDY2,2LDA2,2LDX2,0...
2320DATA1BCS5,1LDA12,0...,0...,1LDY7,1LDA7,1LDX8,0...
2330DATA0CLV0,2LDA4,0TSX0,0...,2LDY3,2LDA3,2LDX4,0...
2340DATA1CPY1,1CMP11,0...,0...,1CPY6,1CMP6,1DEC6,0...
2350DATA0INY0,1CMP1,0DEX0,0...,2CPY2,2CMP2,2DEC2,0...
2360DATA1BNE5,1CMP12,0...,0...,0...,1CMP7,1DEC7,0...
2370DATA0CLD0,2CMP4,0PHX0,0...,0...,2CMP3,2DEC3,0...
2380DATA1CPX1,1SBC11,0...,0...,1CPX6,1SBC6,1INC6,0...
2390DATA0INX0,1SBC1,0NOP0,0...,2CPX2,2SBC2,2INC2,0...
2400DATA1BEQ5,1SBC12,0...,0...,0...,1SBC7,1INC7,0...
2410DATA0SED0,2SBC4,0PLX0,0...,0...,2SBC3,2INC3,0...
2420DATA&FFF7,OSCLI,&FFF4,OSBYTE
2430DATA&FFF1,OSWORD,&FFEE,OSWRCH
2440DATA&FFE7,OSNEWL,&FFE3,OSASCI
2450DATA&FFE0,OSRDCH,&FFDD,OSFILE
2460DATA&FFDA,OSARGS
2470DATA&FFD4,OSBPUT,&FFD7,OSBGET
2480DATA&FFCE,OSFIND,&FFD1,OSGBPB
2490DATA&FFC8,NVWRCH,&FFCB,NVRDCH
2500DATA&FFC2,GSINIT,&FFC5,GSREAD
2510DATA&FFB9,OSRROM,&FFBF,OSEVEN
2520DATA0,*
2530DATA&200,USERV,&202,BRKV
2540DATA&204,IRQ1V,&206,IRQ2V
2550DATA&208,CLIV,&20A,BYTEV
2560DATA&20C,WORDV,&20E,WRCHV
2570DATA&210,RDCHV,&212,FILEV
2580DATA&214,ARGSV,&216,BGETV
2590DATA&218,BPUTV,&21A,GBPBV
2600DATA&21C,FINDV,&21E,FSCV
2610DATA&220,EVNTV,&222,UPTV
2620DATA&224,NETV,&226,VDUV
2630DATA&228,KEYBV,&22A,INSV
2640DATA&22C,REMV,&22E,CRESV
2650DATA0,*
